<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stoichiometric Matrix · ChemistryLab.jl</title><meta name="title" content="Stoichiometric Matrix · ChemistryLab.jl"/><meta property="og:title" content="Stoichiometric Matrix · ChemistryLab.jl"/><meta property="twitter:title" content="Stoichiometric Matrix · ChemistryLab.jl"/><meta name="description" content="Documentation for ChemistryLab.jl."/><meta property="og:description" content="Documentation for ChemistryLab.jl."/><meta property="twitter:description" content="Documentation for ChemistryLab.jl."/><meta property="og:url" content="https://jfbarthelemy.github.io/ChemistryLab.jl/man/stoichio_matrix/"/><meta property="twitter:url" content="https://jfbarthelemy.github.io/ChemistryLab.jl/man/stoichio_matrix/"/><link rel="canonical" href="https://jfbarthelemy.github.io/ChemistryLab.jl/man/stoichio_matrix/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ChemistryLab.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../formula_manipulation/">Chemical Formula Manipulation</a></li><li><a class="tocitem" href="../species/">Species</a></li><li><a class="tocitem" href="../databases/">Database Interoperability</a></li><li class="is-active"><a class="tocitem" href>Stoichiometric Matrix</a><ul class="internal"><li><a class="tocitem" href="#Stochiometric-matrix-for-species"><span>Stochiometric matrix for species</span></a></li><li><a class="tocitem" href="#Stochiometric-matrix-for-cement-species"><span>Stochiometric matrix for cement species</span></a></li><li><a class="tocitem" href="#Stochiometric-matrix-for-species-and-primary-species"><span>Stochiometric matrix for species and primary species</span></a></li></ul></li><li><a class="tocitem" href="../equations/">Chemical reactions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../example/get_stochio_matrix/">Stoichiometric Matrix</a></li><li><a class="tocitem" href="../../example/bogue_calculation/">Bogue Calculation</a></li></ul></li><li><a class="tocitem" href="../../reference/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Stoichiometric Matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stoichiometric Matrix</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jfbarthelemy/ChemistryLab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jfbarthelemy/ChemistryLab.jl/blob/main/docs/src/man/stoichio_matrix.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Stoichiometric-Matrix"><a class="docs-heading-anchor" href="#Stoichiometric-Matrix">Stoichiometric Matrix</a><a id="Stoichiometric-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Stoichiometric-Matrix" title="Permalink"></a></h1><p>From the definition of species, it is possible to construct a stoichiometric matrix that establishes the relationship between species and chemical elements for species or oxides for cement species. This is called canonical decomposition.</p><h2 id="Stochiometric-matrix-for-species"><a class="docs-heading-anchor" href="#Stochiometric-matrix-for-species">Stochiometric matrix for species</a><a id="Stochiometric-matrix-for-species-1"></a><a class="docs-heading-anchor-permalink" href="#Stochiometric-matrix-for-species" title="Permalink"></a></h2><p>Any species can be described as a linear combination of chemical elements. A species vector can be expressed as a function of the chemical elements on which they depend. This dependence leads to the creation of a stochiometric matrix.</p><pre><code class="language-julia hljs">fH2O = 2 * :H + :O
H2O = Species(fH2O)
HSO4 = Species(&quot;HSO₄⁻&quot;)
CO2 = Species(Dict(:C =&gt; 1, :O =&gt; 2); symbol=&quot;CO₂&quot;)
species = [H2O, HSO4, CO2]
canonical_stoich_matrix(species) ;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1">┌────┬─────┬───────┬─────┐</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1">    <span class="sgr32">│</span><span class="sgr36"> H2O </span><span class="sgr32">│</span><span class="sgr36"> HSO₄⁻ </span><span class="sgr32">│</span><span class="sgr36"> CO₂ </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">├────┼─────┼───────┼─────┤</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">  C </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">     0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">   1 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">  H </span><span class="sgr32">│</span><span class="sgr91">   2 </span><span class="sgr32">│</span><span class="sgr91">     1 </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">  S </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">     1 </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">  O </span><span class="sgr32">│</span><span class="sgr91">   1 </span><span class="sgr32">│</span><span class="sgr91">     4 </span><span class="sgr32">│</span><span class="sgr91">   2 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> Zz </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr94">    -1 </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">└────┴─────┴───────┴─────┘</span></span></code></pre><h2 id="Stochiometric-matrix-for-cement-species"><a class="docs-heading-anchor" href="#Stochiometric-matrix-for-cement-species">Stochiometric matrix for cement species</a><a id="Stochiometric-matrix-for-cement-species-1"></a><a class="docs-heading-anchor-permalink" href="#Stochiometric-matrix-for-cement-species" title="Permalink"></a></h2><p>A cement species vector can also be expressed in terms of other species on which they depend. Here, the cement species are expressed in terms of the oxides from which they are composed.</p><pre><code class="language-julia hljs">C3S = CemSpecies(&quot;C3S&quot;)
C2S = CemSpecies(&quot;C2S&quot;)
C3A = CemSpecies(&quot;C3A&quot;)
C4AF = CemSpecies(Dict(:C=&gt;4, :A=&gt;1, :F=&gt;1); name=&quot;C4AF&quot;)
cemspecies = [C3S, C2S, C3A, C4AF]
A, indep_comp = canonical_stoich_matrix(cemspecies)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1">┌───┬─────┬─────┬─────┬──────┐</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1">   <span class="sgr32">│</span><span class="sgr36"> C3S </span><span class="sgr32">│</span><span class="sgr36"> C2S </span><span class="sgr32">│</span><span class="sgr36"> C3A </span><span class="sgr32">│</span><span class="sgr36"> C4AF </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">├───┼─────┼─────┼─────┼──────┤</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> C </span><span class="sgr32">│</span><span class="sgr91">   3 </span><span class="sgr32">│</span><span class="sgr91">   2 </span><span class="sgr32">│</span><span class="sgr91">   3 </span><span class="sgr32">│</span><span class="sgr91">    4 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> S </span><span class="sgr32">│</span><span class="sgr91">   1 </span><span class="sgr32">│</span><span class="sgr91">   1 </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">    0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> A </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">   1 </span><span class="sgr32">│</span><span class="sgr91">    1 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> F </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">    1 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">└───┴─────┴─────┴─────┴──────┘</span></span></code></pre><hr/><h2 id="Stochiometric-matrix-for-species-and-primary-species"><a class="docs-heading-anchor" href="#Stochiometric-matrix-for-species-and-primary-species">Stochiometric matrix for species and primary species</a><a id="Stochiometric-matrix-for-species-and-primary-species-1"></a><a class="docs-heading-anchor-permalink" href="#Stochiometric-matrix-for-species-and-primary-species" title="Permalink"></a></h2><p>The decomposition can also be done according to the primary species previously defined.</p><pre><code class="language-julia hljs">fH2O = 2 * :H + :O
H2O = Species(fH2O)
HSO4 = Species(&quot;HSO₄⁻&quot;)
CO2 = Species(Dict(:C =&gt; 1, :O =&gt; 2); symbol=&quot;CO₂&quot;)
species = [H2O, HSO4, CO2]
A, indep_comp, dep_comp = stoich_matrix(species)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1">┌───────┬─────┬───────┬─────┐</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1">       <span class="sgr32">│</span><span class="sgr36"> H2O </span><span class="sgr32">│</span><span class="sgr36"> HSO₄⁻ </span><span class="sgr32">│</span><span class="sgr36"> CO₂ </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">├───────┼─────┼───────┼─────┤</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">   H2O </span><span class="sgr32">│</span><span class="sgr91">   1 </span><span class="sgr32">│</span></span><span class="sgr8">     0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35"> HSO₄⁻ </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">     1 </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span>
<span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr35">   CO₂ </span><span class="sgr32">│</span></span><span class="sgr8">   0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr8">     0 </span><span class="sgr32"><span class="sgr1">│</span></span><span class="sgr1"><span class="sgr91">   1 </span><span class="sgr32">│</span></span>
<span class="sgr32"><span class="sgr1">└───────┴─────┴───────┴─────┘</span></span></code></pre><p>The primary species of Cemdata18 can be listed with the following command:</p><pre><code class="language-julia hljs">using ChemistryLab #hide
df_elements, df_substances, df_reactions = parse_cemdata18_thermofun(&quot;../../../data/cemdata18-merged.json&quot;) #hide
df_primaries = extract_primary_species(&quot;../../../data/CEMDATA18-31-03-2022-phaseVol.dat&quot;)</code></pre><p>See <a href="../../reference/#ChemistryLab.parse_cemdata18_thermofun-Tuple{Any}"><code>ChemistryLab.parse_cemdata18_thermofun</code></a> and <a href="../../reference/#ChemistryLab.extract_primary_species-Tuple{Any}"><code>ChemistryLab.extract_primary_species</code></a></p><hr/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../databases/">« Database Interoperability</a><a class="docs-footer-nextpage" href="../equations/">Chemical reactions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 15 October 2025 09:37">Wednesday 15 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
